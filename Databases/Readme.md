<Center><font size=5>Databases 文章开坑 </font></center>



#### 写在前面

Databases 模块的文章一直没有兴趣去写，主要有两个原因。

一方面我个人在SQL这块的实践并不多，没有什么经验总结可以写；另外一面我并不是很愿意写一些底层的原理之类的东西，感觉除了面试卖弄以外也并不是很有作用。如果你懂得操作系统方面的知识，数据库这些系统的底层设计也没有超出这些知识之外的内容。

因为虚荣心作祟，文章里面如果没有数据库内容，感觉又少了一块，或者让他人觉得我不懂数据库，那颗太气人了，所以写下这篇开坑文章，算是说服自己，当然我比较懒，可能后续什么也不会写，也不要太意外，哈哈。

#### 1 前言

平时看了一些文章，官方文档也有阅读，同时工作生活种做过一些小的实践，对于数据库基本原理什么的也有些许了解，不能算是专家一类，但也可以说的上是有一些小小的理解。文章种或许有错，还请斧正。

#### 2 会有那些内容

在数据库这些文章里，更多的会是写一些实践类的文章，或者踩到的一些坑，特别值得我记录的一些内容。可能不会有太多针对某个数据库的架构和原理，这些文章中文的英文的非常多，只要用心去互联网上搜索总有所得，而且会比我写的更加的好；另外如上面所说这些其实都是最基础的理论知识的结合，深入研究个人感觉对我来说得不偿失，毕竟我也不是依靠数据库吃饭，用好数据库才是核心生产力。

#### 3 关于数据库

对于数据库，因为个人的工作经历, MySQL 是最早接触的，对于数据库，我简单说一点点，可能有不对，或者粗浅之处，敬请斧正。

* ACID 
* MVCC
* 锁
* undo、redo、binlog

  * undo log ： undo log 提供了数据**撤销**的功能，但究其核心是提供了数据即时访问的能力，保证了数据未被写入文件时，可以被访问到的能力，同时保证了数据不出错。
  * redo log ： 故障恢复的能力。
  * bin log：数据变更日志记录。
* 架构

  * 缓存： Mysql缓存以 Page 为主进行替换，分为
* Server 层 
  
  * 连接器： 负责连接和管理客户端校验
    * 缓存查询：SQL 多次查询缓存命中
    * SQL接口：接受sql语句
    * 解析器：接续SQL语法树，校验SQL
    * 优化器：优化执行顺序、索引等问题
    * 执行器：操作执行引擎
  * 数据库存储引擎
* [架构文章]（https://baijiahao.baidu.com/s?id=1710034614164958724&amp;wfr=spider&amp;for=pc ）



以上问题，让我简单总结一下，首先数据库的目的是高效的组织和存取数据，同时要保证数据的完整性和可靠性，所以简单来讲高效的组织就是减少数据的冗余性，遵守数据库的设计范式就是尽可能的保证数据的同时降低冗余性，同时快速高效的存取显然直接使用硬盘达不到我们的目的，所以缓存相当重要，被引入进来。

引入缓存后存取的效率大大提升了，也带来相应的问题，数据的一致性（内存和硬盘）、数据的安全性（容灾）如何处理，这时候redo log 起作用了， redo log 的作用其实就是在做短时间的刷盘，将日志记录到硬盘中，而减少数据库大量页缓存与硬盘的交换（这种设计在操作系统上比比皆是）， 这样用redo log 做到了容灾，最大限度的保证数据的不丢失。

但显然redo log的刷新时间也是要等待执行commit之后，这期间的数据变化，如何查询获取呢？undo log提供了这个功能，事实上每次执行都是首先记录undo log，相当于记录缓存变化，变换的缓存也叫做脏页，这时候也就有了MVCC的概念 (这是针对查询的，是另一个话题)，undo log 的日志记录脏页变化，同时保证未commit之前可以撤销变化，来保证缓存数据的正确性，而不是被刷新到硬盘中，同时Mysql将 undo log 也是一个特殊的表，所以undo log 的变化也会记录在redo log中，同redo log 一起发挥故障恢复功能，恢复事务中的未提交和回滚。

最后bin log记录数据变化，相当于数据数据变更日志。



在上述问题被解决后， 为了提高效率，又自然而然出现并发，为了支持并发又提出锁，这些都是一步步演化而来，这些内容又和操作系统、CPU这块处理3级缓存的方法大同小异，理解好操作系统、CPU等等原理，数据库这块的原理也就很好理解了。



#### 4 目录

* MySQL

  - [基础](mySQL\Mysql基础命令.md)  - 简单的增删改查

* postgreSQL

  

* Redis



